{"version":3,"file":"wda.js","sources":["../src/util/sleep.ts","../src/util/httpdo.ts","../src/instance/httpclient.ts","../src/instance/alert.ts","../src/config/xcuiElementTypes.ts","../src/instance/Rect.ts","../src/instance/element.ts","../src/instance/selector.ts","../src/instance/session.ts","../src/instance/client.ts","../src/main.ts"],"sourcesContent":["function sleep (time: number): Promise<void> {\n  return new Promise((reslove) => {\n    setTimeout(() => {\n      reslove()\n    }, time)\n  })\n}\n\nexport default sleep","import sleep from '../util/sleep'\nimport rp from 'request-promise'\n\nasync function httpdo (url: string, method: string = 'GET', payload?: any): Promise<any> {\n  // const startTime = new Date().getTime()\n\n  const options = {\n      uri: url,\n      method,\n      body: payload,\n      headers: {\n          'User-Agent': 'Request-Promise'\n      },\n      json: true // Automatically parses the JSON string in the response\n  }\n\n  // Do HTTP Request\n  // console.log(`Shell: curl -X ${method} -d '${payload}' '${url}'`)\n  let res: Response\n  try {\n    res = await rp(options)\n    \n  } catch (e) {\n    // console.log(`retry to connect, error: ${e}`)\n    await sleep(1000)\n    res = await rp(options)\n  }\n  const retjson = res\n  // console.log(`Return {{${new Date().getTime() - startTime}ms}}`, retjson)\n  return retjson\n}\n\nexport default httpdo\n","import httpdo from '../util/httpdo'\n\nconst urljoin = require('url-join')\n\nclass HTTPClient {\n  address: string\n  alertCallback: Function | undefined\n\n  constructor (address: string, alertCallback?: Function) {\n    this.address = address\n    this.alertCallback = alertCallback\n  }\n\n  newClient (path: string) {\n    return new HTTPClient(urljoin(this.address, path), this.alertCallback)\n  }\n\n  async fetch (method: string, url: string, data?: any) {\n    return await this.fetchNoAlert(method, url, data)\n  }\n\n  protected async fetchNoAlert (method: string, queryUrl: string, data?: any, depth?: number): Promise<any> {\n    const targetUrl = urljoin(this.address, queryUrl)\n\n    try {\n      return await httpdo(targetUrl, method, data)\n    } catch (e) {\n      if (depth && depth >= 10) {\n        return Promise.reject(e)\n      }\n      this.alertCallback && this.alertCallback()\n      return await this.fetchNoAlert(method, queryUrl, data, (depth || 0) + 1)\n    }\n  }\n}\n\nexport default HTTPClient\n","import Session from './session'\nimport HTTPClient from './httpclient'\nimport sleep from '../util/sleep'\n\nclass Alert {\n  s: Session\n  http: HTTPClient\n  \n  constructor (session: Session) {\n    this.s = session\n    this.http = session.http\n  }\n\n  async exists () {\n    let text: string\n    try {\n      text = await this.text()\n    } catch (e) {\n      return false\n    }\n    return !!text\n  }\n\n  async text () {\n    const { value } = await this.http.fetch('get', '/alert/text')\n    return typeof value === 'string' ? value : ''\n  }\n\n  async wait (timeout: number = 20) {\n    const startTime = new Date().getTime()\n    while (new Date().getTime() - startTime < (timeout * 1000)) {\n      if ( await this.exists() ) {\n        return true\n      }\n      await sleep(20)\n    } \n    return false\n  }\n\n  accept () {\n    return this.http.fetch('post', '/alert/accept')\n  }\n\n  dismiss () {\n    return this.http.fetch('post', '/alert/dismiss')\n  }\n\n  async buttons () {\n    const { value } = await this.http.fetch('get', '/wda/alert/buttons')\n\n    return value\n  }\n\n  /**\n   * @param name the name of the button\n   */\n  click (name: string) {\n    return this.http.fetch('post', '/alert/accept', { name })\n  }\n}\n\nexport default Alert","const ELEMENTS = [\n  'Any',\n  'Other',\n  'Application',\n  'Group',\n  'Window',\n  'Sheet',\n  'Drawer',\n  'Alert',\n  'Dialog',\n  'Button',\n  'RadioButton',\n  'RadioGroup',\n  'CheckBox',\n  'DisclosureTriangle',\n  'PopUpButton',\n  'ComboBox',\n  'MenuButton',\n  'ToolbarButton',\n  'Popover',\n  'Keyboard',\n  'Key',\n  'NavigationBar',\n  'TabBar',\n  'TabGroup',\n  'Toolbar',\n  'StatusBar',\n  'Table',\n  'TableRow',\n  'TableColumn',\n  'Outline',\n  'OutlineRow',\n  'Browser',\n  'CollectionView',\n  'Slider',\n  'PageIndicator',\n  'ProgressIndicator',\n  'ActivityIndicator',\n  'SegmentedControl',\n  'Picker',\n  'PickerWheel',\n  'Switch',\n  'Toggle',\n  'Link',\n  'Image',\n  'Icon',\n  'SearchField',\n  'ScrollView',\n  'ScrollBar',\n  'StaticText',\n  'TextField',\n  'SecureTextField',\n  'DatePicker',\n  'TextView',\n  'Menu',\n  'MenuItem',\n  'MenuBar',\n  'MenuBarItem',\n  'Map',\n  'WebView',\n  'IncrementArrow',\n  'DecrementArrow',\n  'Timeline',\n  'RatingIndicator',\n  'ValueIndicator',\n  'SplitGroup',\n  'Splitter',\n  'RelevanceIndicator',\n  'ColorWell',\n  'HelpTag',\n  'Matte',\n  'DockItem',\n  'Ruler',\n  'RulerMarker',\n  'Grid',\n  'LevelIndicator',\n  'Cell',\n  'LayoutArea',\n  'LayoutItem',\n  'Handle',\n  'Stepper',\n  'Tab'\n]\n\nexport default ELEMENTS\n","class Rect {\n  x: number\n  y: number\n  width: number\n  height:  number\n\n  constructor (x: number, y: number, width: number, height:  number) {\n    this.x = x\n    this.y = y\n    this.width = width\n    this.height = height\n  }\n\n  getCenter () {\n    const [x, y] = [ this.x+this.width/2, this.y+this.height/2 ]\n    return [x, y]\n  }\n\n  getOrigin () {\n    const { x, y } = this\n    return [x, y]\n  }\n\n  getLeft() {\n    return this.x\n  }\n\n  getTop() {\n    return this.y\n  }\n\n  getRight() {\n    return this.x + this.width\n  }\n\n  getBottom() {\n    return this.y + this.height\n  }\n}\n\nexport default Rect\n","import HTTPClient from './httpclient'\nimport Rect from './Rect'\n\nclass Element {\n  http: HTTPClient\n  private id: string\n  constructor (httpclient: HTTPClient, id: string) {\n    this.http = httpclient\n    this.id = id\n  }\n\n  private req (method: string, url: string, data?: any) {\n    return this.http.fetch(method, '/element/' + this.id + url, data)\n  }\n\n  private wdaReq (method: string, url: string, data?: any) {\n    return this.http.fetch(method, '/wda/element/' + this.id + url, data)\n  }\n\n  private async prop (key: string) {\n    const { value } = await this.req('get', '/' + key.replace(/\\/$/, ''))\n    return value\n  }\n\n  private async wdaProp (key: string) {\n    const { value } = await this.wdaReq('get', '/' + key.replace(/\\/$/, ''))\n    return value\n  }\n\n  getId () {\n    return this.id\n  }\n\n  async getLabel () {\n    return await this.prop('attribute/label')\n  }\n\n  async getClassName () {\n    return await this.prop('attribute/type')\n  }\n\n  async getText () {\n    return await this.prop('text')\n  }\n\n  async getName () {\n    return await this.prop('name')\n  }\n\n  async getDisplayed () {\n    return await this.prop('displayed')\n  }\n\n  async getEnabled () {\n    return await this.prop('enabled')\n  }\n\n  async getValue () {\n    return await this.prop('value')\n  }\n\n  async getVisible () {\n    return await this.prop('visible')\n  }\n\n  async getBounds () {\n    const value = await this.prop('rect')\n    const { x, y, width: w, height: h } = value \n    return new Rect(x, y, w, h)\n  }\n  \n  async getAccessible () {\n    return await this.wdaProp('accessible')\n  }\n\n  async getAccessibilityContainer () {\n    return await this.wdaProp('accessibilityContainer')\n  }\n\n  // operations\n  async tap () {\n    return await this.req('post', '/click')\n  }\n\n  async click () {\n    // Alias of tap\n    return await this.tap()\n  }\n\n  /** Tap and hold for a moment\n   * @param duration seconds of hold time\n   * [[FBRoute POST:@\"/wda/element/:uuid/touchAndHold\"] respondWithTarget:self action:@selector(handleTouchAndHold:)]\n   */\n  async tapHold (duration: number = 1) {\n    return await this.wdaReq('post', '/touchAndHold', {'duration': duration})\n  }\n\n  /**\n   * \n   * @param direction one of \"visible\", \"up\", \"down\", \"left\", \"right\"\n   * @param distance swipe distance, only works when direction is not \"visible\"\n   * \n   * distance=1.0 means, element (width or height) multiply 1.0\n   */\n  async scroll (direction: \"visible\"|\"up\"|\"down\"|\"left\"|\"right\" = 'visible', distance:number = 1.0) {\n    if (direction === \"visible\") {\n      return await this.wdaReq('post', '/scroll', {'toVisible': true})\n    } else if (['up', 'down', 'left', 'right'].indexOf(direction) > -1) {\n      return await this.wdaReq('post', '/scroll', {'direction': direction, 'distance': distance})\n    } else {\n      throw \"Invalid direction\"\n    }\n  }\n\n  /**\n   * \n   * @param scale scale must > 0\n   * @param velocity velocity must be less than zero when scale is less than 1\n   * Example:\n            pinchIn  -> scale:0.5, velocity: -1\n            pinchOut -> scale:2.0, velocity: 1\n   */\n  async pinch (scale: number, velocity: number) {\n    return await this.wdaReq('post', '/pinch', { scale, velocity })\n  }\n\n  async setText (value: string) {\n    return await this.req('post', '/value', {'value': value})\n  }\n\n  async clearText () {\n    return await this.req('post', '/clear')\n  }\n}\n\nexport default Element\n","import Session from \"./session\";\nimport HTTPClient from './httpclient'\nimport ELEMENTS from '../config/xcuiElementTypes'\nimport sleep from '../util/sleep'\nimport Element from './element'\n\ninterface SelectorObj {\n  predicate: string // predicate string\n  id: string // raw identifier\n  className: string // attr of className\n  type: string // alias of className\n  name: string // attr for name\n  nameContains: string // attr of name contains\n  nameMatches: string // regex string\n  text: string // alias of name\n  textContains: string // alias of nameContains\n  textMatches: string // alias of nameMatches\n  value: string // attr of value, not used in most times\n  valueContains: string // attr of value contains\n  label: string // attr for label\n  labelContains: string // attr for label contains\n  visible: boolean // is visible\n  enabled: boolean // is enabled\n  classChain: string // string of ios chain query, eg: **/XCUIElementTypeOther[`value BEGINSWITH 'blabla'`]\n  xpath: string // xpath string, a little slow, but works fine\n  timeout: number // maxium wait element time, default 10.0s\n  index: number // index of founded elements\n  parentClassChains: string[]\n}\n\nclass Selector {\n  http: HTTPClient\n  session: Session\n\n  predicate: string\n  id: string\n  className: string\n  name: string\n  namePart: string\n  nameRegex: string\n  value: string\n  valuePart: string\n  label: string\n  labelPart: string\n  visible: boolean\n  enabled: boolean\n  index: number\n  xpath: string\n  classChain: string\n  timeout: number\n  parentClassChains: string[]\n\n  // WDA use two key to find elements \"using\", \"value\"\n  // Examples:\n  // \"using\" can be on of \n  //     \"partial link text\", \"link text\"\n  //     \"name\", \"id\", \"accessibility id\"\n  //     \"class name\", \"class chain\", \"xpath\", \"predicate string\"\n  \n  // predicate string support many keys\n  //     UID,\n  //     accessibilityContainer,\n  //     accessible,\n  //     enabled,\n  //     frame,\n  //     label,\n  //     name,\n  //     rect,\n  //     type,\n  //     value,\n  //     visible,\n  //     wdAccessibilityContainer,\n  //     wdAccessible,\n  //     wdEnabled,\n  //     wdFrame,\n  //     wdLabel,\n  //     wdName,\n  //     wdRect,\n  //     wdType,\n  //     wdUID,\n  //     wdValue,\n  //     wdVisible\n  constructor (httpclient: HTTPClient, session: Session, selectorObj: SelectorObj) {\n    this.http = httpclient\n    this.session = session\n\n    this.predicate = selectorObj.predicate\n    this.id = selectorObj.id\n    this.className = selectorObj.className || selectorObj.type\n    this.name = this.addEscapeCharacterForQuotePrimeCharacter(selectorObj.name || selectorObj.text)\n    this.namePart = selectorObj.nameContains || selectorObj.textContains\n    this.nameRegex = selectorObj.nameMatches || selectorObj.textMatches\n    this.value = selectorObj.value\n    this.valuePart = selectorObj.valueContains\n    this.label = selectorObj.label\n    this.labelPart = selectorObj.labelContains\n    this.enabled = selectorObj.enabled\n    this.visible = selectorObj.visible\n    this.index = selectorObj.index || 0\n\n    this.xpath = this.fixXcuiType(selectorObj.xpath)\n    this.classChain = this.fixXcuiType(selectorObj.classChain)\n    this.timeout = selectorObj.timeout || 10\n    this.parentClassChains = selectorObj.parentClassChains || []\n\n    // some fixtures\n    if (this.className && !this.className.startsWith('XCUIElementType')) {\n      this.className = 'XCUIElementType' + this.className\n    }\n\n    if (this.nameRegex) {\n      if (!this.nameRegex.startsWith('^') && this.nameRegex.startsWith('.*')) {\n        this.nameRegex = '.*' + this.nameRegex\n      }\n      if (!this.nameRegex.endsWith('$') && !this.nameRegex.endsWith('.*')) {\n        this.nameRegex = this.nameRegex + '.*'\n      }\n    }\n  }\n\n  /**\n   * Fix for https://github.com/openatx/facebook-wda/issues/33\n   *    \n   * @param v\n   * @return string with properly formated quotes, or non changed text\n   */\n  private addEscapeCharacterForQuotePrimeCharacter (text: string = '') {\n    return text.replace(\"'\", \"\\\\'\").replace('\"','\\\\\"')\n  }\n\n  private fixXcuiType (s: string) {\n    if (!s) return ''\n    const reElement = ELEMENTS.join('|')\n\n    return s.replace(new RegExp(\"(\" + reElement + \")\"), a => 'XCUIElementType' + a)\n  }\n\n  /**\n    HTTP example response:\n    [\n        {\"ELEMENT\": \"E2FF5B2A-DBDF-4E67-9179-91609480D80A\"},\n        {\"ELEMENT\": \"597B1A1E-70B9-4CBE-ACAD-40943B0A6034\"}\n    ]\n   */\n  private async wdasearch (using: string, value: string): Promise<any[]> {\n    const elementIds: any[] = []\n    let { value: data } = await this.http.fetch('post', '/elements', { using , value })\n    data = typeof data === 'string' ? [] : data\n\n    data.forEach((d: any) => {\n      elementIds.push(d['ELEMENT'])\n    })\n    return elementIds\n  }\n\n  // just return if aleady exists predicate\n  private genClassChain () {\n    if (this.predicate) {\n      return '/XCUIElementTypeAny[`' + this.predicate + '`]'\n    }\n\n    const qs: string[] = []\n    if (this.name) {\n      qs.push(`name == '${this.name}'`)\n    }\n    if (this.namePart) {\n      qs.push(`name CONTAINS '${this.namePart}'`)\n    }\n    if (this.nameRegex) {\n      qs.push(`name MATCHES '${this.nameRegex}'`)\n    }\n    if (this.label) {\n      qs.push(`label == '${this.label}'`)\n    }\n    if (this.labelPart) {\n      qs.push(`label CONTAINS '${this.labelPart}'`)\n    }\n    if (this.value) {\n      qs.push(`value == '${this.value}'`)\n    }\n    if (this.valuePart) {\n      qs.push(`value CONTAINS ’${this.valuePart}'`)\n    }\n    if (this.visible !== null && this.visible !== undefined) {\n      qs.push(`visible == ${this.visible.toString()}`)\n    }\n    if (this.enabled !== null && this.enabled !== undefined) {\n      qs.push(`enabled == ${this.enabled.toString()}`)\n    }\n    const predicate = qs.join(' AND ')\n    let chain = '/' + (this.className || 'XCUIElementTypeAny')\n    if (predicate) {\n      chain = chain + '[`' + predicate + '`]'\n    }\n    if (this.index) {\n      chain = chain + `[${this.index}]`\n    }\n    return chain\n  }\n\n  findElementIds () {\n    if (this.id)\n      return this.wdasearch('id', this.id)\n    if (this.predicate)\n      return this.wdasearch('predicate string', this.predicate)\n    if (this.xpath)\n      return this.wdasearch('xpath', this.xpath)\n    if (this.classChain)\n      return this.wdasearch('class chain', this.classChain)\n\n    const chain = '**' + this.parentClassChains.join() + this.genClassChain()\n    return this.wdasearch('class chain', chain)\n  }\n\n  // return Element (list): all the elements\n  async findElements () {\n    const es: any[] = []\n    const ids = await this.findElementIds()\n    ids.forEach(id => {\n      const e = new Element(this.http.newClient(''), id)\n      es.push(e)\n    })\n    return es\n  }\n\n  async count () {\n    const ids = await this.findElementIds()\n    return ids.length\n  }\n\n  /**\n   * \n   * @param timeout timeout for query element, unit seconds Default 10s\n   * @return Element: UI Element\n   */\n  async get (timeout: number = this.timeout): Promise<Element> {\n    const startTime = new Date().getTime()\n    while (true) {\n      const elems = await this.findElements()\n      if (elems.length > 0){\n        return elems[0]\n      }     \n      if (startTime + (timeout * 1000) < new Date().getTime()) {\n        break\n      }\n     await sleep(10)\n    }\n    // check alert again\n    const exists = await this.session.alert().exists()\n    if (exists && this.http.alertCallback) {\n      this.http.alertCallback()\n      return await this.get(timeout)\n    }\n    return Promise.reject([])\n  }\n\n  // Set element wait timeout\n  setTimeout (s: number) {\n    this.timeout = s\n    return this\n  }\n\n  child(selectorObj: SelectorObj) {\n    const chain = this.genClassChain()\n    selectorObj['parentClassChains'] = this.parentClassChains.concat([chain])\n    return new Selector(this.http, this.session, selectorObj)\n  }\n    \n  async exists () {\n    const ids = await this.findElementIds()\n    return ids.length > this.index\n  }\n\n  /**\n   * Wait element and perform click\n   * @param timeout timeout for wait\n   * @returns bool: if successfully clicked\n   */\n  async clickExists (timeout: number = 0) {\n    let e: Element\n    try {\n      e = await this.get(timeout)\n    } catch (e) {\n      return false\n    }\n    await e.click()\n    return true\n  }\n\n  /**\n   * alias of get\n   * @param timeout timeout seconds\n   */\n  async wait (timeout: number = this.timeout) {\n    return await this.get(timeout)\n  }\n\n  async waitGone (timeout: number = this.timeout) {\n    const startTime = new Date().getTime()\n    while (startTime + (timeout * 1000) > new Date().getTime()) {\n      if (!await this.exists()) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nexport default Selector\nexport {\n  SelectorObj\n}\n","import HTTPClient from './httpclient'\nimport Alert from './alert'\nimport Selector, { SelectorObj } from './selector'\n\nclass Session {\n  http: HTTPClient\n  capabilities: any\n  alertCallback: Function\n  private sid: string\n\n  /**\n   * @param httpclient HTTPClient\n   * @param value get status object\n   */\n  constructor (httpclient: HTTPClient, value: any) {\n    this.http = httpclient\n\n    // Example session value\n    // \"capabilities\": {\n    //     \"CFBundleIdentifier\": \"com.netease.aabbcc\",\n    //     \"browserName\": \"?????\",\n    //     \"device\": \"iphone\",\n    //     \"sdkVersion\": \"10.2\"\n    // }\n    this.capabilities = value.capabilities\n    this.sid = value.sessionId\n  }\n\n  protected getId () {\n    return this.sid\n  }\n\n  // the session matched bundle id\n  protected getBundleId () {\n    return this.capabilities.CFBundleIdentifier\n  }\n  \n  /**\n   * @param callback called when alert popup\n   */\n  setAlertCallback (callback: Function) {\n    this.alertCallback = callback\n  }\n\n  /**\n   * TODO: Never successed using before.\n   * https://github.com/facebook/WebDriverAgent/blob/master/WebDriverAgentLib/Commands/FBSessionCommands.m#L43\n   * \n   * @param url string\n   */\n  async openUrl (url: string) {\n    return await this.http.fetch('post', 'url', {'url': url})\n  }\n\n  /**\n   * @param duration deactivate time, seconds\n   */\n  deactivate (duration: number) {\n    return this.http.fetch('post', '/wda/deactivateApp', { duration })\n  }\n\n  tap (x: number, y: number) {\n    return this.http.fetch('post', '/wda/tap/0', { x, y })\n  }\n\n  doubleTap (x: number, y: number) {\n    return this.http.fetch('post', '/wda/doubleTap', { x, y })\n  }\n\n  /**\n   * Tap and hold for a moment\n   * @param x position x\n   * @param y position y\n   * @param duration seconds of hold time\n   * \n   * [[FBRoute POST:@\"/wda/touchAndHold\"] respondWithTarget:self action:@selector(handleTouchAndHoldCoordinate:)]\n   */\n  tapHold (x: number, y: number, duration: number) {\n    return this.http.fetch('post', '/wda/touchAndHold', { x, y, duration })\n  }\n\n  /**\n   * \n   * @param fromX position fromX\n   * @param fromY position fromY\n   * @param toX position toX\n   * @param toY position toY\n   * @param duration start coordinate press duration (seconds)\n   * \n   * [[FBRoute POST:@\"/wda/dragfromtoforduration\"] respondWithTarget:self action:@selector(handleDragCoordinate:)]\n   */\n  swipe (fromX: number, fromY: number, toX: number, toY: number, duration: number = 0) {\n    return this.http.fetch('post', '/wda/dragfromtoforduration', { fromX, fromY, toX, toY, duration })\n  }\n\n  async swipeLeft () {\n    const { width, height } = await this.getWindowSize()\n    return this.swipe(width/2 + 150, height/2, width/2 - 150, height/2)\n  }\n\n  async swipeRight () {\n    const { width, height } = await this.getWindowSize()\n    return this.swipe(width/2 - 150, height/2, width/2 + 150, height/2)\n  }\n\n  async swipeUp () {\n    const { width, height } = await this.getWindowSize()\n    return this.swipe(width/2, height/2 + 150, width/2, height/2 - 150)\n  }\n\n  async swipeDown () {\n    const { width, height } = await this.getWindowSize()\n    return this.swipe(width/2, height/2 - 150, width/2, height/2 + 150)\n  }\n\n  /**\n   * @param orientation  LANDSCAPE | PORTRAIT | UIA_DEVICE_ORIENTATION_LANDSCAPERIGHT |\n                    UIA_DEVICE_ORIENTATION_PORTRAIT_UPSIDEDOWN\n   */\n  async orientation (orientation?: string) {\n    const { value } = !orientation ? await this.http.fetch('get', 'orientation') : await this.http.fetch('post', 'orientation', { orientation })\n    return value\n  }\n\n  alert (): Alert {\n    return new Alert(this)\n  }\n\n  close () {\n    return this.http.fetch('delete', '/')\n  }\n  \n  selector (selectorObj: SelectorObj) {\n    const httpclient = this.http.newClient('')\n    return new Selector(httpclient, this, selectorObj)\n  }\n\n  /**\n   * get window size\n   */\n  private async getWindowSize (): Promise<{ width: number, height: number }> {\n    const { value } = await this.http.fetch('get', '/window/size')\n    return value\n  }\n\n}\n\nexport default Session\n","import HTTPClient from './httpclient'\nimport Session from './session'\nimport fs from 'fs'\n\nclass Client {\n  http: HTTPClient\n\n  // Args:\n  // target (string): the device url\n\n  // If target is None, set to \"http://localhost:8100\"\n  constructor (url: string = 'http://localhost:8100') {\n    this.http = new HTTPClient(url)\n  }\n\n  async status () {\n    const res = await this.http.fetch('get', 'status')\n\n    return res\n  }\n\n  async home () {\n    // Press home button\n    return await this.http.fetch('post', '/wda/homescreen')\n  }\n\n  async healthcheck () {\n    // Hit healthcheck\n    return await this.http.fetch('get', '/wda/healthcheck')\n  }\n\n  async source (format: 'xml' | 'json' = 'xml', accessible: boolean = false) {\n    // Args:\n    //   format (str): only 'xml' and 'json' source types are supported\n    //   accessible (bool): when set to true, format is always 'json'\n    let res: any\n    if (accessible) {\n      res = await this.http.fetch('get', '/wda/accessibleSource')\n    } else {\n      res = await this.http.fetch('get', 'source?format=' + format)\n    }\n    return res.value\n  }\n\n  async session (bundleId?: string, args: string[] = [], environment: any = {}) {\n    // Args:\n    //     - bundle_id (str): the app bundle id\n    //     - arguments (list): ['-u', 'https://www.google.com/ncr']\n    //     - enviroment (dict): {\"KEY\": \"VAL\"}\n    // WDA Return json like\n    // {\n    //     \"value\": {\n    //         \"sessionId\": \"69E6FDBA-8D59-4349-B7DE-A9CA41A97814\",\n    //         \"capabilities\": {\n    //             \"device\": \"iphone\",\n    //             \"browserName\": \"部落冲突\",\n    //             \"sdkVersion\": \"9.3.2\",\n    //             \"CFBundleIdentifier\": \"com.supercell.magic\"\n    //         }\n    //     },\n    //     \"sessionId\": \"69E6FDBA-8D59-4349-B7DE-A9CA41A97814\",\n    //     \"status\": 0\n    // }\n    // To create a new session, send json data like\n    // {\n    //     \"desiredCapabilities\": {\n    //         \"bundleId\": \"your-bundle-id\",\n    //         \"app\": \"your-app-path\"\n    //         \"shouldUseCompactResponses\": (bool),\n    //         \"shouldUseTestManagerForVisibilityDetection\": (bool),\n    //         \"maxTypingFrequency\": (integer),\n    //         \"arguments\": (list(str)),\n    //         \"environment\": (dict: str->str)\n    //     },\n    // }\n\n    if (!bundleId) {\n      const status = await this.status()\n      const sid = status['sessionId']\n      if (!sid) {\n        throw 'no session created ever'\n      }\n\n      const http = this.http.newClient('session/' + sid)\n      const { value } = await http.fetch('get', '/')\n      return await new Session(http, value)\n    }\n\n    if (!Array.isArray(args)) {\n      throw 'arguments must be a array'\n    }\n\n    if (typeof environment !== 'object') {\n      throw 'environment must be a object'\n    }\n\n    const capabilities = {\n      bundleId,\n      arguments: args,\n      environment,\n      shouldWaitForQuiescence: true,\n    }\n\n    const data = {\n      desiredCapabilities: capabilities\n    }\n\n    const res = await this.http.fetch('post', 'session', data)\n    const httpclient = this.http.newClient('session/' + res.sessionId)\n    const value = await httpclient.fetch('get', '/')\n    return new Session(httpclient, value)\n  }\n\n  /**\n   * Screenshot with PNG format\n   * \n   * @param pngFilename optional, save file name\n   * @return png raw data\n   */\n  async screenshot (pngFilename: string = 'screenshot.png') {\n    const { value } = await this.http.fetch('get', 'screenshot')\n    fs.writeFileSync(pngFilename, value, 'base64')\n    return value\n  }\n}\n\nexport default Client\n","import Client from './instance/client'\n\nconst wda = {\n  Client\n}\n\nexport default wda"],"names":[],"mappings":"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"}